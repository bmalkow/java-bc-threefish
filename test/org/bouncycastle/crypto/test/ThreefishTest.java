package org.bouncycastle.crypto.test;

import org.bouncycastle.crypto.engines.ThreefishEngine;
import org.bouncycastle.crypto.params.KeyParameter;
import org.bouncycastle.crypto.params.ThreefishParameters;
import org.bouncycastle.util.encoders.Hex;
import org.bouncycastle.util.test.SimpleTest;

public class ThreefishTest extends CipherTest {

	static SimpleTest[] tests = {
			new BlockCipherVectorTest(0, new ThreefishEngine(), new ThreefishParameters(
					Hex.decode("0000000000000000000000000000000000000000000000000000000000000000"),
					Hex.decode("00000000000000000000000000000000")),
					"0000000000000000000000000000000000000000000000000000000000000000",
					"84da2a1f8beaee947066ae3e3103f1ad536db1f4a1192495116b9f3ce6133fd8"),

			new BlockCipherVectorTest(1, new ThreefishEngine(), new ThreefishParameters(
					Hex.decode("101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F"),
					Hex.decode("000102030405060708090A0B0C0D0E0F")),
					"FFFEFDFCFBFAF9F8F7F6F5F4F3F2F1F0EFEEEDECEBEAE9E8E7E6E5E4E3E2E1E0",
					"E0D091FF0EEA8FDFC98192E62ED80AD59D865D08588DF476657056B5955E97DF"),

			new BlockCipherVectorTest(
					2,
					new ThreefishEngine(512),
					new ThreefishParameters(
							Hex.decode("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
							Hex.decode("00000000000000000000000000000000")),
					"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
					"b1a2bbc6ef6025bc40eb3822161f36e375d1bb0aee3186fbd19e47c5d479947b7bc2f8586e35f0cff7e7f03084b0b7b1f1ab3961a580a3e97eb41ea14a6d7bbe"),
			new BlockCipherVectorTest(
					3,
					new ThreefishEngine(512),
					new ThreefishParameters(
							Hex.decode("101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"),
							Hex.decode("000102030405060708090a0b0c0d0e0f")),
					"fffefdfcfbfaf9f8f7f6f5f4f3f2f1f0efeeedecebeae9e8e7e6e5e4e3e2e1e0dfdedddcdbdad9d8d7d6d5d4d3d2d1d0cfcecdcccbcac9c8c7c6c5c4c3c2c1c0",
					"e304439626d45a2cb401cad8d636249a6338330eb06d45dd8b36b90e97254779272a0a8d99463504784420ea18c9a725af11dffea10162348927673d5c1caf3d"),

			new BlockCipherVectorTest(
					4,
					new ThreefishEngine(1024),
					new ThreefishParameters(
							Hex.decode("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
							Hex.decode("00000000000000000000000000000000")),
					"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
					"F05C3D0A3D05B304F785DDC7D1E036015C8AA76E2F217B06C6E1544C0BC1A90DF0ACCB9473C24E0FD54FEA68057F43329CB454761D6DF5CF7B2E9B3614FBD5A20B2E4760B40603540D82EABC5482C171C832AFBE68406BC39500367A592943FA9A5B4A43286CA3C4CF46104B443143D560A4B230488311DF4FEEF7E1DFE8391E"),
			new BlockCipherVectorTest(
					5,
					new ThreefishEngine(1024),
					new ThreefishParameters(
							Hex.decode("101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"),
							Hex.decode("000102030405060708090a0b0c0d0e0f")),
					"fffefdfcfbfaf9f8f7f6f5f4f3f2f1f0efeeedecebeae9e8e7e6e5e4e3e2e1e0dfdedddcdbdad9d8d7d6d5d4d3d2d1d0cfcecdcccbcac9c8c7c6c5c4c3c2c1c0bfbebdbcbbbab9b8b7b6b5b4b3b2b1b0afaeadacabaaa9a8a7a6a5a4a3a2a1a09f9e9d9c9b9a999897969594939291908f8e8d8c8b8a89888786858483828180",
					"a6654ddbd73cc3b05dd777105aa849bce49372eaaffc5568d254771bab85531c94f780e7ffaae430d5d8af8c70eebbe1760f3b42b737a89cb363490d670314bd8aa41ee63c2e1f45fbd477922f8360b388d6125ea6c7af0ad7056d01796e90c83313f4150a5716b30ed5f569288ae974ce2b4347926fce57de44512177dd7cde"),

	};

	public static void main(String[] args) {

		runTest(new ThreefishTest());
	}

	ThreefishTest() {
		super(tests, new ThreefishEngine(), new KeyParameter(new byte[32]));
	}

	@Override
	public String getName() {
		return "Threefish";
	}
}
